<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¸ì¬ìœ¡ì„±ë¶€ êµìœ¡ ê´€ë¦¬ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header .badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
            margin-top: 10px;
        }

        .system-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .system-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .system-btn.admin {
            background: #28a745;
            color: white;
        }

        .system-btn.student {
            background: #007bff;
            color: white;
        }

        .system-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .system-content {
            padding: 30px;
            min-height: 500px;
        }

        .hidden {
            display: none;
        }

        /* ê´€ë¦¬ì ì‹œìŠ¤í…œ ìŠ¤íƒ€ì¼ */
        .admin-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .admin-nav-btn {
            padding: 10px 20px;
            border: none;
            background: #f8f9fa;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-nav-btn.active {
            background: #28a745;
            color: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        /* êµìœ¡ìƒ ì‹œìŠ¤í…œ ìŠ¤íƒ€ì¼ */
        .student-form {
            max-width: 500px;
            margin: 0 auto;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .attendance-status {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            border-radius: 10px;
            font-weight: bold;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .current-time {
            text-align: center;
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 20px;
        }

        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            background: #fafafa;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: #4a90e2;
            background: #f0f7ff;
        }

        .file-upload input[type="file"] {
            margin: 10px 0;
        }

        .quick-access {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quick-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 25px;
            background: #007bff;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .course-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 25px;
            text-align: center;
        }

        .course-info h3 {
            color: #1976d2;
            margin-bottom: 5px;
        }

        .course-info p {
            color: #424242;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ì¸ì¬ìœ¡ì„±ë¶€ êµìœ¡ ê´€ë¦¬ì‹œìŠ¤í…œ</h1>
            <p>Education Management System</p>
            <div class="badge" id="system-badge">ì‹œìŠ¤í…œ ì„ íƒ</div>
        </div>

        <div class="system-selector" id="system-selector">
            <button class="system-btn admin" onclick="showSystem('admin')">ğŸ”§ ê´€ë¦¬ì ì‹œìŠ¤í…œ</button>
            <button class="system-btn student" onclick="showSystem('student')">ğŸ‘¥ êµìœ¡ìƒ ì‹œìŠ¤í…œ</button>
        </div>

        <!-- ê´€ë¦¬ì ì‹œìŠ¤í…œ -->
        <div id="admin-system" class="system-content hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="color: #28a745;">ğŸ”§ ê´€ë¦¬ì ì‹œìŠ¤í…œ</h2>
                <button class="btn btn-primary" onclick="showSystemSelector()">â† ë©”ì¸ìœ¼ë¡œ</button>
            </div>
            
            <div class="admin-nav">
                <button class="admin-nav-btn active" onclick="showAdminSection('course')">ê³¼ì • ê´€ë¦¬</button>
                <button class="admin-nav-btn" onclick="showAdminSection('attendance')">ì¶œì„ ê´€ë¦¬</button>
                <button class="admin-nav-btn" onclick="showAdminSection('data')">ë°ì´í„° ê´€ë¦¬</button>
            </div>

            <!-- ê³¼ì • ê´€ë¦¬ -->
            <div id="course-section">
                <h3>ê³¼ì • ê´€ë¦¬</h3>
                
                <div class="form-group">
                    <label for="course-name">ê³¼ì •ëª…</label>
                    <input type="text" id="course-name" placeholder="ê³¼ì •ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                
                <div class="form-group">
                    <label for="course-date">êµìœ¡ ë‚ ì§œ</label>
                    <input type="date" id="course-date">
                </div>
                
                <button class="btn btn-success" onclick="addCourse()">ê³¼ì • ì¶”ê°€</button>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>ê³¼ì •ID</th>
                            <th>ê³¼ì •ëª…</th>
                            <th>êµìœ¡ ë‚ ì§œ</th>
                            <th>ë“±ë¡ëœ êµìœ¡ìƒ ìˆ˜</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="course-list">
                    </tbody>
                </table>
            </div>

            <!-- ì¶œì„ ê´€ë¦¬ -->
            <div id="attendance-section" class="hidden">
                <h3>ì¶œì„ ê´€ë¦¬</h3>
                
                <div class="form-group">
                    <label for="select-course">ê³¼ì • ì„ íƒ</label>
                    <select id="select-course">
                        <option value="">ê³¼ì •ì„ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>
                
                <!-- êµìœ¡ìƒ ë“±ë¡ ë°©ë²• ì„ íƒ -->
                <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                    <div class="file-upload" style="flex: 1;">
                        <h4>ğŸ“„ Excel íŒŒì¼ ì—…ë¡œë“œ</h4>
                        <p>ì´ë¦„, ì‚¬ë²ˆ ì»¬ëŸ¼ì´ í¬í•¨ëœ Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                        <input type="file" id="excel-file" accept=".xlsx,.xls" onchange="uploadExcel()">
                    </div>
                    
                    <div class="file-upload" style="flex: 1;">
                        <h4>âœï¸ ìˆ˜ê¸° ì…ë ¥</h4>
                        <div class="form-group" style="margin-bottom: 10px;">
                            <input type="text" id="manual-name" placeholder="ì´ë¦„ ì…ë ¥" style="margin-bottom: 8px;">
                            <input type="text" id="manual-employee-id" placeholder="ì‚¬ë²ˆ ì…ë ¥">
                        </div>
                        <button class="btn btn-primary" onclick="addStudentManually()" style="width: 100%;">êµìœ¡ìƒ ì¶”ê°€</button>
                    </div>
                </div>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>ì´ë¦„</th>
                            <th>ì‚¬ë²ˆ</th>
                            <th>ì…ì‹¤ ì‹œê°„</th>
                            <th>í‡´ì‹¤ ì‹œê°„</th>
                            <th>ì¶œì„ ìƒíƒœ</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="attendance-list">
                    </tbody>
                </table>
            </div>

            <!-- ë°ì´í„° ê´€ë¦¬ -->
            <div id="data-section" class="hidden">
                <h3>ë°ì´í„° ê´€ë¦¬</h3>
                
                <div style="background: #e8f5e8; border: 1px solid #28a745; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h4>ğŸ’¾ ë°ì´í„° ì €ì¥ ìƒíƒœ</h4>
                    <p>ëª¨ë“  ë°ì´í„°ëŠ” ìë™ìœ¼ë¡œ ë¸Œë¼ìš°ì €ì— ì €ì¥ë©ë‹ˆë‹¤.</p>
                    <p id="save-status">âœ… ë°ì´í„° ì €ì¥ë¨</p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-success" onclick="manualSave()">ìˆ˜ë™ ì €ì¥</button>
                        <button class="btn btn-primary" onclick="manualRefresh()" style="margin-left: 10px;">ê°•ë ¥í•œ ìƒˆë¡œê³ ì¹¨</button>
                        <button class="btn btn-primary" onclick="forceSyncData()" style="margin-left: 10px;">ê°•ì œ ë™ê¸°í™”</button>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        ğŸ’¡ ì¶œì„ì´ ë°˜ì˜ ì•ˆ ë  ë•Œ: "ê°•ë ¥í•œ ìƒˆë¡œê³ ì¹¨" ë˜ëŠ” "ê°•ì œ ë™ê¸°í™”" í´ë¦­
                    </p>
                </div>

                <div style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h4>ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</h4>
                    <p>ëª¨ë“  ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    <button class="btn btn-primary" onclick="exportAllData()">ì „ì²´ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                </div>

                <div style="background: #f8d7da; border: 1px solid #dc3545; border-radius: 8px; padding: 20px;">
                    <h4>ğŸ—‘ï¸ ë°ì´í„° ì´ˆê¸°í™”</h4>
                    <p>âš ï¸ ì£¼ì˜: ëª¨ë“  ê³¼ì • ë° ì¶œì„ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.</p>
                    <button class="btn btn-danger" onclick="resetAllData()">ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”</button>
                </div>
            </div>
        </div>

        <!-- êµìœ¡ìƒ ì‹œìŠ¤í…œ -->
        <div id="student-system" class="system-content hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="color: #007bff;">ğŸ‘¥ êµìœ¡ìƒ ì¶œì„ ì‹œìŠ¤í…œ</h2>
                <button class="btn btn-primary" onclick="showSystemSelector()">â† ë©”ì¸ìœ¼ë¡œ</button>
            </div>
            
            <div class="student-form">
                <div class="current-time" id="current-time"></div>
                
                <div id="course-info-section"></div>
                
                <div class="form-group">
                    <label for="student-name">ì´ë¦„</label>
                    <input type="text" id="student-name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                
                <div class="form-group">
                    <label for="student-id">ì‚¬ë²ˆ</label>
                    <input type="text" id="student-id" placeholder="ì‚¬ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                
                <div class="form-group">
                    <label for="attendance-type">ì¶œì„ êµ¬ë¶„</label>
                    <select id="attendance-type">
                        <option value="checkin">ì…ì‹¤</option>
                        <option value="checkout">í‡´ì‹¤</option>
                    </select>
                </div>
                
                <button class="btn btn-primary" onclick="markAttendance()" style="width: 100%;">ì¶œì„í•˜ê¸°</button>
                
                <div id="attendance-result"></div>
            </div>
        </div>
    </div>

    <!-- ë¹ ë¥¸ ì ‘ê·¼ ë²„íŠ¼ -->
    <div class="quick-access" id="quick-access" style="display: none;">
        <button class="quick-btn" onclick="showSystem('student')" title="êµìœ¡ìƒ ì¶œì„">ğŸ‘¥ ì¶œì„</button>
        <button class="quick-btn" onclick="showSystem('admin')" title="ê´€ë¦¬ì">ğŸ”§ ê´€ë¦¬</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // ì „ì—­ ë°ì´í„° ì €ì¥ì†Œ
        let educationData = {
            courses: [],
            students: {},
            attendance: {},
            courseIdCounter: 1
        };

        // ë°ì´í„°ë¥¼ ë¸Œë¼ìš°ì €ì— ì €ì¥ (íƒ­ ê°„ ë™ê¸°í™” ê°•í™”)
        function saveDataToBrowser() {
            try {
                const dataString = JSON.stringify(educationData);
                const timestamp = new Date().getTime();
                
                console.log('=== ë°ì´í„° ì €ì¥ ì‹œì‘ ===');
                console.log('ì €ì¥í•  ë°ì´í„°:', educationData);
                
                // 1. sessionStorageì— ì €ì¥
                sessionStorage.setItem('educationSystemData', dataString);
                sessionStorage.setItem('educationSystemData_timestamp', timestamp.toString());
                console.log('âœ… sessionStorage ì €ì¥ ì™„ë£Œ');
                
                // 2. localStorageì— ì €ì¥ (íƒ­ ê°„ ê³µìœ ìš©)
                localStorage.setItem('educationSystemData', dataString);
                localStorage.setItem('educationSystemData_timestamp', timestamp.toString());
                console.log('âœ… localStorage ì €ì¥ ì™„ë£Œ');
                
                // 3. íƒ­ ê°„ ë™ê¸°í™”ë¥¼ ìœ„í•œ íŠ¹ìˆ˜ í‚¤ (storage ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°ìš©)
                localStorage.setItem('educationSystemData_sync_trigger', timestamp.toString());
                
                // 4. ê°•ì œë¡œ ë¸Œë¼ìš°ì € ì €ì¥ì†Œ ë™ê¸°í™”
                sessionStorage.setItem('educationSystemData_force', Math.random().toString());
                localStorage.setItem('educationSystemData_force', Math.random().toString());
                
                // 5. ê¸€ë¡œë²Œ ë³€ìˆ˜ì—ë„ ì €ì¥
                window.globalEducationData = JSON.parse(JSON.stringify(educationData));
                window.globalEducationTimestamp = timestamp;
                
                // 6. BroadcastChannelì„ í†µí•œ íƒ­ ê°„ í†µì‹  (ìµœì‹  ë¸Œë¼ìš°ì € ì§€ì›)
                if (window.BroadcastChannel) {
                    if (!window.educationBroadcast) {
                        window.educationBroadcast = new BroadcastChannel('educationSystem');
                    }
                    window.educationBroadcast.postMessage({
                        type: 'dataUpdate',
                        data: educationData,
                        timestamp: timestamp
                    });
                    console.log('âœ… BroadcastChannel ë©”ì‹œì§€ ì „ì†¡');
                }
                
                console.log('âœ… ë°ì´í„° ì €ì¥ ì™„ë£Œ - íƒ€ì„ìŠ¤íƒ¬í”„:', timestamp);
                
                // ë°ì´í„° ë³€ê²½ ì´ë²¤íŠ¸ ë°œìƒ
                window.dispatchEvent(new CustomEvent('educationDataChanged', {
                    detail: { timestamp: timestamp, data: educationData }
                }));
                
            } catch (error) {
                console.error('âŒ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error);
            }
        }

        // íƒ­ ê°„ ë°ì´í„° ë™ê¸°í™” ë¦¬ìŠ¤ë„ˆ ì„¤ì • (ì™„ì „ ìˆ˜ë™ ë²„ì „)
        function setupCrossTabSync() {
            console.log('ğŸ”— íƒ­ ê°„ ë™ê¸°í™” ì„¤ì • ì¤‘ (ì™„ì „ ìˆ˜ë™)...');
            
            // 1. localStorage ë³€ê²½ ê°ì§€ (ë‹¤ë¥¸ íƒ­ì—ì„œì˜ ë³€ê²½) - ì•Œë¦¼ë§Œ í‘œì‹œ
            window.addEventListener('storage', function(e) {
                console.log('ğŸ”„ Storage ì´ë²¤íŠ¸ ê°ì§€:', e.key, e.newValue);
                
                if (e.key === 'educationSystemData_sync_trigger') {
                    console.log('ğŸ”„ ë‹¤ë¥¸ íƒ­ì—ì„œ ë°ì´í„° ë³€ê²½ë¨');
                    
                    // ë°ì´í„°ë§Œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¡°ìš©íˆ ë¡œë“œ (UI ë³€ê²½ ì—†ìŒ)
                    loadDataFromBrowser();
                    
                    // ì•Œë¦¼ë§Œ í‘œì‹œ (ìë™ ìƒˆë¡œê³ ì¹¨ ì ˆëŒ€ ì•ˆ í•¨)
                    showUpdateAvailableNotification();
                }
                
                if (e.key === 'educationSystemData' && e.newValue) {
                    console.log('ğŸ”„ ì§ì ‘ ë°ì´í„° ë³€ê²½ ê°ì§€');
                    // ë°ì´í„°ë§Œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¡°ìš©íˆ ë™ê¸°í™” (UI ë³€ê²½ ì—†ìŒ)
                    loadDataFromBrowser();
                }
            });
            
            // 2. BroadcastChannel ë¦¬ìŠ¤ë„ˆ - ì•Œë¦¼ë§Œ í‘œì‹œ
            if (window.BroadcastChannel) {
                if (!window.educationBroadcast) {
                    window.educationBroadcast = new BroadcastChannel('educationSystem');
                }
                
                window.educationBroadcast.addEventListener('message', function(event) {
                    console.log('ğŸ“¡ BroadcastChannel ë©”ì‹œì§€ ìˆ˜ì‹ :', event.data);
                    
                    if (event.data.type === 'dataUpdate') {
                        // ë°ì´í„°ë§Œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë™ê¸°í™” (UI ë³€ê²½ ì ˆëŒ€ ì•ˆ í•¨)
                        educationData = JSON.parse(JSON.stringify(event.data.data));
                        window.globalEducationData = educationData;
                        window.globalEducationTimestamp = event.data.timestamp;
                        
                        console.log('ğŸ”„ BroadcastChannelì„ í†µí•œ ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° ë™ê¸°í™”');
                        
                        // ì•Œë¦¼ë§Œ í‘œì‹œ (UI ìƒˆë¡œê³ ì¹¨ ì ˆëŒ€ ì•ˆ í•¨)
                        showUpdateAvailableNotification();
                    }
                });
                
                console.log('âœ… BroadcastChannel ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ (ìˆ˜ë™ ëª¨ë“œ)');
            }
            
            // 3. í˜ì´ì§€ í¬ì»¤ìŠ¤ ì‹œì—ë„ ì•Œë¦¼ë§Œ í‘œì‹œ (ìë™ ìƒˆë¡œê³ ì¹¨ ì•ˆ í•¨)
            window.addEventListener('focus', function() {
                console.log('ğŸ”„ í˜ì´ì§€ í¬ì»¤ìŠ¤ - ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° í™•ì¸');
                setTimeout(() => {
                    const oldTimestamp = window.globalEducationTimestamp || 0;
                    loadDataFromBrowser(); // ë°ì´í„°ë§Œ ì¡°ìš©íˆ ë¡œë“œ
                    const newTimestamp = window.globalEducationTimestamp || 0;
                    
                    if (newTimestamp > oldTimestamp) {
                        console.log('ğŸ†• í¬ì»¤ìŠ¤ ì‹œ ìƒˆë¡œìš´ ë°ì´í„° ë°œê²¬ - ì•Œë¦¼ë§Œ í‘œì‹œ');
                        showUpdateAvailableNotification();
                    }
                }, 200);
            });
            
            console.log('âœ… íƒ­ ê°„ ë™ê¸°í™” ì„¤ì • ì™„ë£Œ (ì™„ì „ ìˆ˜ë™ ëª¨ë“œ)');
        }

        // ì—…ë°ì´íŠ¸ ê°€ëŠ¥ ì•Œë¦¼ í‘œì‹œ (ê´€ë¦¬ì ì‹œìŠ¤í…œì—ì„œë§Œ)
        function showUpdateAvailableNotification() {
            // êµìœ¡ìƒ ì‹œìŠ¤í…œì—ì„œëŠ” ì•Œë¦¼ í‘œì‹œ ì•ˆ í•¨
            if (!document.getElementById('student-system').classList.contains('hidden')) {
                console.log('ğŸš« êµìœ¡ìƒ ì‹œìŠ¤í…œì—ì„œëŠ” ì—…ë°ì´íŠ¸ ì•Œë¦¼ í‘œì‹œ ì•ˆ í•¨');
                return;
            }
            
            // ê´€ë¦¬ì ì‹œìŠ¤í…œì´ ì•„ë‹Œ ê²½ìš°ì—ë„ ì•Œë¦¼ í‘œì‹œ ì•ˆ í•¨
            if (document.getElementById('admin-system').classList.contains('hidden')) {
                console.log('ğŸš« ê´€ë¦¬ì ì‹œìŠ¤í…œì´ í™œì„±í™”ë˜ì§€ ì•Šì•„ ì•Œë¦¼ í‘œì‹œ ì•ˆ í•¨');
                return;
            }
            
            // ê¸°ì¡´ ì•Œë¦¼ì´ ìˆìœ¼ë©´ ì œê±°
            const existingNotice = document.getElementById('update-available-notice');
            if (existingNotice) {
                existingNotice.remove();
            }
            
            console.log('ğŸ’¡ ê´€ë¦¬ì ì‹œìŠ¤í…œì— ì—…ë°ì´íŠ¸ ì•Œë¦¼ í‘œì‹œ');
            
            const notice = document.createElement('div');
            notice.id = 'update-available-notice';
            notice.style.cssText = `
                position: fixed; top: 10px; right: 10px; 
                background: #ffc107; color: #212529; 
                padding: 15px 18px; border-radius: 10px; 
                font-size: 0.9rem; z-index: 1000;
                box-shadow: 0 6px 16px rgba(0,0,0,0.15);
                border: 2px solid #ffca2c;
                cursor: pointer;
                animation: gentleBounce 0.6s ease-out;
                max-width: 300px;
                user-select: none;
            `;
            notice.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.2em;">ğŸ’¡</span>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 1em;">ìƒˆë¡œìš´ ì¶œì„ ë°ì´í„°</div>
                        <div style="font-size: 0.85em; margin-top: 3px; opacity: 0.8;">
                            í´ë¦­í•´ì„œ í™•ì¸í•˜ê¸° (í˜„ì¬ ì‘ì—… ìœ ì§€ë¨)
                        </div>
                    </div>
                    <div style="font-size: 0.7rem; opacity: 0.5; margin-left: 5px;">Ã—</div>
                </div>
            `;
            
            // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
            if (!document.getElementById('gentle-bounce-style')) {
                const style = document.createElement('style');
                style.id = 'gentle-bounce-style';
                style.textContent = `
                    @keyframes gentleBounce {
                        0% { opacity: 0; transform: translateX(100%) scale(0.8); }
                        60% { opacity: 1; transform: translateX(-10px) scale(1.05); }
                        80% { transform: translateX(5px) scale(0.95); }
                        100% { opacity: 1; transform: translateX(0) scale(1); }
                    }
                    @keyframes fadeOutRight {
                        0% { opacity: 1; transform: translateX(0) scale(1); }
                        100% { opacity: 0; transform: translateX(100%) scale(0.8); }
                    }
                `;
                document.head.appendChild(style);
            }
            
            // í´ë¦­ ì‹œì—ë§Œ ìƒˆë¡œê³ ì¹¨ (ì ˆëŒ€ ìë™ ì•ˆ í•¨)
            notice.addEventListener('click', function() {
                console.log('ğŸ”„ ê´€ë¦¬ì í´ë¦­ - ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ (ìƒíƒœ ë³´ì¡´)');
                
                // ìƒíƒœ ë³´ì¡´í•˜ë©° UI ìƒˆë¡œê³ ì¹¨
                forceRefreshAllUI();
                
                notice.remove();
                
                // ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ ì•Œë¦¼
                showQuickNotification('âœ… ìµœì‹  ì¶œì„ ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸ (ì‘ì—… ë‚´ìš© ìœ ì§€)', '#28a745');
            });
            
            document.body.appendChild(notice);
            
            // 20ì´ˆ í›„ ìë™ ì‚¬ë¼ì§
            setTimeout(() => {
                if (notice.parentNode) {
                    notice.style.animation = 'fadeOutRight 0.4s ease-in';
                    setTimeout(() => {
                        if (notice.parentNode) notice.remove();
                    }, 400);
                }
            }, 20000);
        }

        // ë¹ ë¥¸ ì•Œë¦¼ í‘œì‹œ (ê´€ë¦¬ì ì‹œìŠ¤í…œì—ì„œë§Œ)
        function showQuickNotification(message, color = '#17a2b8') {
            // êµìœ¡ìƒ ì‹œìŠ¤í…œì—ì„œëŠ” ì•Œë¦¼ í‘œì‹œ ì•ˆ í•¨
            if (!document.getElementById('student-system').classList.contains('hidden')) {
                console.log('ğŸš« êµìœ¡ìƒ ì‹œìŠ¤í…œì—ì„œëŠ” ë¹ ë¥¸ ì•Œë¦¼ í‘œì‹œ ì•ˆ í•¨');
                return;
            }
            
            const notice = document.createElement('div');
            notice.style.cssText = `
                position: fixed; top: 10px; right: 10px; 
                background: ${color}; color: white; 
                padding: 8px 12px; border-radius: 6px; 
                font-size: 0.8rem; z-index: 1000;
                box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                animation: slideInRight 0.3s ease-out;
            `;
            notice.textContent = message;
            
            // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
            if (!document.getElementById('quick-notice-style')) {
                const style = document.createElement('style');
                style.id = 'quick-notice-style';
                style.textContent = `
                    @keyframes slideInRight {
                        from { opacity: 0; transform: translateX(100%); }
                        to { opacity: 1; transform: translateX(0); }
                    }
                    @keyframes slideOutRight {
                        from { opacity: 1; transform: translateX(0); }
                        to { opacity: 0; transform: translateX(100%); }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(notice);
            setTimeout(() => {
                notice.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => notice.remove(), 300);
            }, 2000);
        }

        // ë¸Œë¼ìš°ì €ì—ì„œ ë°ì´í„° ë³µêµ¬ (ê°•ë ¥í•œ ë²„ì „)
        function loadDataFromBrowser() {
            try {
                console.log('=== ë°ì´í„° ë¡œë”© ì‹œì‘ ===');
                
                let dataString = null;
                let source = '';
                
                // 1ìˆœìœ„: ê¸€ë¡œë²Œ ë³€ìˆ˜ì—ì„œ ì½ê¸°
                if (window.globalEducationData) {
                    educationData = JSON.parse(JSON.stringify(window.globalEducationData));
                    window.lastDataTimestamp = window.globalEducationTimestamp || 0;
                    source = 'globalVariable';
                    console.log('âœ… ê¸€ë¡œë²Œ ë³€ìˆ˜ì—ì„œ ë°ì´í„° ë¡œë“œ ì„±ê³µ');
                    return true;
                }
                
                // 2ìˆœìœ„: sessionStorage
                dataString = sessionStorage.getItem('educationSystemData');
                if (dataString) {
                    source = 'sessionStorage';
                } else {
                    // 3ìˆœìœ„: localStorage  
                    dataString = localStorage.getItem('educationSystemData');
                    if (dataString) {
                        source = 'localStorage';
                    }
                }
                
                if (dataString) {
                    const loadedData = JSON.parse(dataString);
                    
                    // ë°ì´í„° ë¬´ê²°ì„± ê²€ì‚¬
                    if (loadedData && loadedData.courses && loadedData.students && loadedData.attendance) {
                        educationData = loadedData;
                        
                        // ê¸€ë¡œë²Œ ë³€ìˆ˜ì—ë„ ë³µì‚¬
                        window.globalEducationData = JSON.parse(JSON.stringify(educationData));
                        
                        // íƒ€ì„ìŠ¤íƒ¬í”„ ë³µêµ¬
                        window.lastDataTimestamp = parseInt(
                            sessionStorage.getItem('educationSystemData_timestamp') || 
                            localStorage.getItem('educationSystemData_timestamp') || 
                            '0'
                        );
                        window.globalEducationTimestamp = window.lastDataTimestamp;
                        
                        console.log(`âœ… ë°ì´í„° ë¡œë”© ì„±ê³µ (${source}):`, educationData);
                        console.log('ê³¼ì • ìˆ˜:', educationData.courses.length);
                        console.log('ì „ì²´ ì¶œì„ ë°ì´í„°:', educationData.attendance);
                        
                        return true;
                    } else {
                        console.error('âŒ ë°ì´í„° êµ¬ì¡°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤:', loadedData);
                    }
                } else {
                    console.log('âš ï¸ ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
                }
                
                return false;
                
            } catch (error) {
                console.error('âŒ ë°ì´í„° ë³µêµ¬ ì‹¤íŒ¨:', error);
                return false;
            }
        }

        // ê°•ì œ ë°ì´í„° ë™ê¸°í™” (ìºì‹œ ë¬´ì‹œ)
        function forceSyncData() {
            console.log('=== ê°•ì œ ë°ì´í„° ë™ê¸°í™” ===');
            
            // í˜„ì¬ ë©”ëª¨ë¦¬ì˜ ë°ì´í„°ë¥¼ ê°•ì œë¡œ ì €ì¥
            saveDataToBrowser();
            
            // ì ì‹œ í›„ ë‹¤ì‹œ ë¡œë“œí•˜ì—¬ ë™ê¸°í™” í™•ì¸
            setTimeout(() => {
                const oldData = JSON.stringify(educationData);
                loadDataFromBrowser();
                const newData = JSON.stringify(educationData);
                
                if (oldData !== newData) {
                    console.log('ğŸ”„ ë°ì´í„° ë™ê¸°í™” í™•ì¸ë¨');
                    forceRefreshAllUI();
                } else {
                    console.log('âœ… ë°ì´í„°ê°€ ì´ë¯¸ ë™ê¸°í™”ë¨');
                }
            }, 100);
        }

        // ëª¨ë“  UI ê°•ì œ ìƒˆë¡œê³ ì¹¨ (ì‚¬ìš©ì ì„ íƒ ìƒíƒœ ë³´ì¡´)
        function forceRefreshAllUI() {
            console.log('=== ì „ì²´ UI ê°•ì œ ìƒˆë¡œê³ ì¹¨ (ìƒíƒœ ë³´ì¡´) ===');
            
            try {
                // í˜„ì¬ ì‚¬ìš©ì ì„ íƒ ìƒíƒœ ì €ì¥
                const currentStates = {
                    selectedCourse: document.getElementById('select-course')?.value || '',
                    activeAdminSection: getActiveAdminSection(),
                    currentSystem: getCurrentSystem()
                };
                
                console.log('í˜„ì¬ ìƒíƒœ ì €ì¥:', currentStates);
                
                // ê³¼ì • ëª©ë¡ ì—…ë°ì´íŠ¸
                updateCourseList();
                console.log('ê³¼ì • ëª©ë¡ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                
                // ê³¼ì • ì„ íƒ ì˜µì…˜ ì—…ë°ì´íŠ¸
                updateCourseSelect();
                console.log('ê³¼ì • ì„ íƒ ì˜µì…˜ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                
                // ì´ì „ ì„ íƒ ìƒíƒœ ë³µì›
                if (currentStates.selectedCourse) {
                    setTimeout(() => {
                        const selectElement = document.getElementById('select-course');
                        if (selectElement) {
                            selectElement.value = currentStates.selectedCourse;
                            console.log('ê³¼ì • ì„ íƒ ìƒíƒœ ë³µì›:', currentStates.selectedCourse);
                            
                            // ì¶œì„ í˜„í™©ë„ ë³µì›
                            if (!document.getElementById('attendance-section').classList.contains('hidden')) {
                                updateAttendanceList();
                                console.log('ì¶œì„ í˜„í™© ë³µì› ì™„ë£Œ');
                            }
                        }
                    }, 100);
                }
                
                // êµìœ¡ìƒ í™”ë©´ ì—…ë°ì´íŠ¸ (êµìœ¡ìƒ ì‹œìŠ¤í…œì´ ì—´ë ¤ìˆëŠ” ê²½ìš°)
                if (!document.getElementById('student-system').classList.contains('hidden')) {
                    findTodayCourse();
                    console.log('êµìœ¡ìƒ í™”ë©´ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                }
                
                console.log('âœ… ì „ì²´ UI ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ (ìƒíƒœ ë³´ì¡´)');
            } catch (error) {
                console.error('âŒ UI ìƒˆë¡œê³ ì¹¨ ì¤‘ ì˜¤ë¥˜:', error);
            }
        }

        // í˜„ì¬ í™œì„±í™”ëœ ê´€ë¦¬ì ì„¹ì…˜ í™•ì¸
        function getActiveAdminSection() {
            if (!document.getElementById('attendance-section').classList.contains('hidden')) {
                return 'attendance';
            } else if (!document.getElementById('course-section').classList.contains('hidden')) {
                return 'course';
            } else if (!document.getElementById('data-section').classList.contains('hidden')) {
                return 'data';
            }
            return 'course'; // ê¸°ë³¸ê°’
        }

        // í˜„ì¬ ì‹œìŠ¤í…œ í™•ì¸
        function getCurrentSystem() {
            if (!document.getElementById('admin-system').classList.contains('hidden')) {
                return 'admin';
            } else if (!document.getElementById('student-system').classList.contains('hidden')) {
                return 'student';
            }
            return 'main';
        }

        // ë°ì´í„° ë³€ê²½ ê°ì§€ ë° ìë™ ìƒˆë¡œê³ ì¹¨ (ì™„ì „ ë¹„í™œì„±í™”)
        function checkForDataUpdates() {
            // ëª¨ë“  ìë™ UI ì—…ë°ì´íŠ¸ ê¸°ëŠ¥ ë¹„í™œì„±í™”
            console.log('ğŸš« ìë™ UI ì—…ë°ì´íŠ¸ ê¸°ëŠ¥ ë¹„í™œì„±í™”ë¨');
            
            // ë°ì´í„°ë§Œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¡°ìš©íˆ ë¡œë“œ (UI ë³€ê²½ ì—†ìŒ)
            try {
                loadDataFromBrowser();
            } catch (error) {
                console.error('ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // URL í•´ì‹œ ê¸°ë°˜ ë¼ìš°íŒ… (ìë™ ìƒˆë¡œê³ ì¹¨ ì œê±°)
        function handleHashChange() {
            const hash = window.location.hash.substring(1);
            
            console.log(`=== í•´ì‹œ ë³€ê²½: ${hash} ===`);
            
            // í•´ì‹œ ë³€ê²½ ì‹œ ë°ì´í„°ë§Œ ë¡œë“œ (UI ìë™ ìƒˆë¡œê³ ì¹¨ ì œê±°)
            loadDataFromBrowser();
            
            if (hash === 'admin') {
                showSystem('admin');
            } else if (hash === 'student') {
                showSystem('student');
            } else {
                showSystemSelector();
            }
        }

        // ì‹œìŠ¤í…œ ì„ íƒ í™”ë©´ í‘œì‹œ
        function showSystemSelector() {
            document.getElementById('system-selector').classList.remove('hidden');
            document.getElementById('admin-system').classList.add('hidden');
            document.getElementById('student-system').classList.add('hidden');
            document.getElementById('quick-access').style.display = 'flex';
            document.getElementById('system-badge').textContent = 'ì‹œìŠ¤í…œ ì„ íƒ';
            stopAdminAutoRefresh(); // ìë™ ê°±ì‹  ì¤‘ì§€
            window.location.hash = '';
        }

        // ì‹œìŠ¤í…œ ì „í™˜ (ì™„ì „ ê°œì„  ë²„ì „)
        function showSystem(type) {
            console.log(`=== ì‹œìŠ¤í…œ ì „í™˜: ${type} ===`);
            
            document.getElementById('system-selector').classList.add('hidden');
            document.getElementById('admin-system').classList.add('hidden');
            document.getElementById('student-system').classList.add('hidden');
            document.getElementById('quick-access').style.display = 'none';
            
            // ì‹œìŠ¤í…œ ì „í™˜ ì‹œ ë¬´ì¡°ê±´ ìµœì‹  ë°ì´í„° ë¡œë“œ
            const dataLoaded = loadDataFromBrowser();
            console.log('ë°ì´í„° ë¡œë“œ ê²°ê³¼:', dataLoaded);
            
            if (type === 'admin') {
                document.getElementById('admin-system').classList.remove('hidden');
                document.getElementById('system-badge').textContent = 'Administrator';
                
                // 500ms í›„ UI ê°•ì œ ì—…ë°ì´íŠ¸ (DOM ë Œë”ë§ ì™„ë£Œ ëŒ€ê¸°)
                setTimeout(() => {
                    console.log('ê´€ë¦¬ì ì‹œìŠ¤í…œ UI ì—…ë°ì´íŠ¸ ì‹œì‘');
                    forceRefreshAllUI();
                }, 500);
                
                startAdminAutoRefresh();
                window.location.hash = 'admin';
                
            } else if (type === 'student') {
                document.getElementById('student-system').classList.remove('hidden');
                document.getElementById('system-badge').textContent = 'Student Portal';
                updateCurrentTime();
                if (window.timeInterval) clearInterval(window.timeInterval);
                window.timeInterval = setInterval(updateCurrentTime, 1000);
                
                // 500ms í›„ UI ê°•ì œ ì—…ë°ì´íŠ¸
                setTimeout(() => {
                    console.log('êµìœ¡ìƒ ì‹œìŠ¤í…œ UI ì—…ë°ì´íŠ¸ ì‹œì‘');
                    findTodayCourse();
                }, 500);
                
                stopAdminAutoRefresh();
                window.location.hash = 'student';
            }
        }

        // ê´€ë¦¬ì í™”ë©´ ìë™ ê°±ì‹  ì‹œì‘ (ì™„ì „ ë¹„í™œì„±í™”)
        function startAdminAutoRefresh() {
            // ëª¨ë“  ìë™ ê°±ì‹  ê¸°ëŠ¥ ë¹„í™œì„±í™”
            console.log('ğŸš« ìë™ ê°±ì‹  ê¸°ëŠ¥ ë¹„í™œì„±í™”ë¨ - ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ë§Œ ê°€ëŠ¥');
            
            // ê¸°ì¡´ ì¸í„°ë²Œ ì •ë¦¬
            if (window.adminRefreshInterval) {
                clearInterval(window.adminRefreshInterval);
                window.adminRefreshInterval = null;
            }
        }

        // ê´€ë¦¬ì í™”ë©´ ìë™ ê°±ì‹  ì¤‘ì§€
        function stopAdminAutoRefresh() {
            if (window.adminRefreshInterval) {
                clearInterval(window.adminRefreshInterval);
                window.adminRefreshInterval = null;
                console.log('ğŸ›‘ ê´€ë¦¬ì ìë™ ê°±ì‹  ì¤‘ì§€');
            }
        }

        // ê´€ë¦¬ì ì„¹ì…˜ ì „í™˜ (ê°•í™” ë²„ì „)
        function showAdminSection(section) {
            console.log(`=== ê´€ë¦¬ì ì„¹ì…˜ ì „í™˜: ${section} ===`);
            
            document.querySelectorAll('.admin-nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('course-section').classList.add('hidden');
            document.getElementById('attendance-section').classList.add('hidden');
            document.getElementById('data-section').classList.add('hidden');
            
            // ì„¹ì…˜ ì „í™˜í•  ë•Œë§ˆë‹¤ ë°ì´í„° ê°•ì œ ë¡œë“œ
            loadDataFromBrowser();
            
            if (section === 'course') {
                document.getElementById('course-section').classList.remove('hidden');
                event.target.classList.add('active');
                setTimeout(() => {
                    updateCourseList();
                    console.log('ê³¼ì • ê´€ë¦¬ í™”ë©´ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                }, 200);
                
            } else if (section === 'attendance') {
                document.getElementById('attendance-section').classList.remove('hidden');
                event.target.classList.add('active');
                setTimeout(() => {
                    updateCourseSelect();
                    console.log('ì¶œì„ ê´€ë¦¬ í™”ë©´ - ê³¼ì • ì„ íƒ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                    
                    // ê³¼ì •ì´ ì´ë¯¸ ì„ íƒë˜ì–´ ìˆë‹¤ë©´ ì¶œì„ í˜„í™©ë„ ê°•ì œ ì—…ë°ì´íŠ¸
                    const selectedCourse = document.getElementById('select-course').value;
                    if (selectedCourse) {
                        setTimeout(() => {
                            updateAttendanceList();
                            console.log('ì¶œì„ í˜„í™© ê°•ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                        }, 300);
                    }
                }, 200);
                
            } else if (section === 'data') {
                document.getElementById('data-section').classList.remove('hidden');
                event.target.classList.add('active');
            }
        }

        // í˜„ì¬ ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ko-KR');
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                timeElement.textContent = `í˜„ì¬ ì‹œê°„: ${timeString}`;
            }
        }

        // ê³¼ì • ì¶”ê°€
        function addCourse() {
            const name = document.getElementById('course-name').value;
            const date = document.getElementById('course-date').value;
            
            if (!name || !date) {
                alert('ê³¼ì •ëª…ê³¼ êµìœ¡ ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            const course = {
                id: educationData.courseIdCounter++,
                name: name,
                date: date,
                students: []
            };
            
            educationData.courses.push(course);
            educationData.students[course.id] = [];
            educationData.attendance[course.id] = {};
            
            document.getElementById('course-name').value = '';
            document.getElementById('course-date').value = '';
            
            updateCourseList();
            saveDataToBrowser(); // ë°ì´í„° ì €ì¥
            alert('ê³¼ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ê³¼ì • ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateCourseList() {
            const tbody = document.getElementById('course-list');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            educationData.courses.forEach(course => {
                const row = tbody.insertRow();
                const studentCount = educationData.students[course.id] ? educationData.students[course.id].length : 0;
                row.innerHTML = `
                    <td>${course.id}</td>
                    <td>${course.name}</td>
                    <td>${course.date}</td>
                    <td>${studentCount}ëª…</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteCourse(${course.id})">ì‚­ì œ</button>
                    </td>
                `;
            });
        }

        // ìˆ˜ë™ ì €ì¥
        function manualSave() {
            saveDataToBrowser();
            document.getElementById('save-status').innerHTML = 'âœ… ìˆ˜ë™ ì €ì¥ ì™„ë£Œ (' + new Date().toLocaleTimeString('ko-KR') + ')';
        }

        // ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ (ìƒíƒœ ë³´ì¡´ ë²„ì „)
        function manualRefresh() {
            console.log('=== ì‚¬ìš©ì ìš”ì²­ - ê°•ë ¥í•œ ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ (ìƒíƒœ ë³´ì¡´) ===');
            
            // í˜„ì¬ ì„ íƒ ìƒíƒœ ì €ì¥
            const selectedCourse = document.getElementById('select-course')?.value || '';
            console.log('ì €ì¥ëœ ê³¼ì • ì„ íƒ:', selectedCourse);
            
            // 1ë‹¨ê³„: ìºì‹œ ì™„ì „ ë¬´ì‹œí•˜ê³  ë°ì´í„° ë¡œë“œ
            delete window.globalEducationData;
            delete window.globalEducationTimestamp;
            
            // 2ë‹¨ê³„: ì €ì¥ì†Œì—ì„œ ê°•ì œ ë¡œë“œ
            loadDataFromBrowser();
            
            // 3ë‹¨ê³„: UI ìƒˆë¡œê³ ì¹¨ (ìƒíƒœ ë³´ì¡´)
            setTimeout(() => {
                forceRefreshAllUI();
                console.log('âœ… ê°•ë ¥í•œ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ (ìƒíƒœ ë³´ì¡´)');
                
                // ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ ì•Œë¦¼
                const notice = document.createElement('div');
                notice.style.cssText = `
                    position: fixed; top: 10px; right: 10px; 
                    background: #007bff; color: white; 
                    padding: 8px 12px; border-radius: 5px; 
                    font-size: 0.8rem; z-index: 1000;
                `;
                notice.textContent = 'âœ… ê°•ë ¥í•œ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ (ì„ íƒ ìƒíƒœ ìœ ì§€)';
                document.body.appendChild(notice);
                setTimeout(() => notice.remove(), 3000);
            }, 200);
        }

        // ì „ì²´ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        function exportAllData() {
            try {
                const dataString = JSON.stringify(educationData, null, 2);
                const blob = new Blob([dataString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `êµìœ¡ê´€ë¦¬ì‹œìŠ¤í…œ_ë°±ì—…_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('ë°ì´í„° ë‚´ë³´ë‚´ê¸°ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                alert('ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                console.error(error);
            }
        }

        // ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”
        function resetAllData() {
            if (confirm('âš ï¸ ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                if (confirm('âš ï¸ ë§ˆì§€ë§‰ í™•ì¸: ëª¨ë“  ê³¼ì •, êµìœ¡ìƒ, ì¶œì„ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    // ë¸Œë¼ìš°ì € ì €ì¥ì†Œë„ í•¨ê»˜ ì´ˆê¸°í™”
                    sessionStorage.removeItem('educationSystemData');
                    localStorage.removeItem('educationSystemData');
                    
                    educationData = {
                        courses: [],
                        students: {},
                        attendance: {},
                        courseIdCounter: 1
                    };
                    
                    updateCourseList();
                    updateCourseSelect();
                    updateAttendanceList();
                    findTodayCourse();
                    saveDataToBrowser();
                    
                    alert('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            }
        }

        // ê³¼ì • ì‚­ì œ
        function deleteCourse(courseId) {
            if (confirm('ì •ë§ë¡œ ì´ ê³¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                educationData.courses = educationData.courses.filter(course => course.id !== courseId);
                delete educationData.students[courseId];
                delete educationData.attendance[courseId];
                updateCourseList();
                updateCourseSelect();
                saveDataToBrowser(); // ë°ì´í„° ì €ì¥
            }
        }

        // ê³¼ì • ì„ íƒ ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateCourseSelect() {
            const select = document.getElementById('select-course');
            if (!select) return;
            
            select.innerHTML = '<option value="">ê³¼ì •ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            
            educationData.courses.forEach(course => {
                const option = document.createElement('option');
                option.value = course.id;
                option.textContent = `${course.name} (${course.date})`;
                select.appendChild(option);
            });
        }

        // ìˆ˜ê¸°ë¡œ êµìœ¡ìƒ ì¶”ê°€
        function addStudentManually() {
            const courseId = document.getElementById('select-course').value;
            const name = document.getElementById('manual-name').value.trim();
            const employeeId = document.getElementById('manual-employee-id').value.trim();
            
            if (!courseId) {
                alert('ë¨¼ì € ê³¼ì •ì„ ì„ íƒí•˜ì„¸ìš”.');
                return;
            }
            
            if (!name || !employeeId) {
                alert('ì´ë¦„ê³¼ ì‚¬ë²ˆì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            // ì¤‘ë³µ í™•ì¸
            if (educationData.attendance[courseId] && educationData.attendance[courseId][employeeId]) {
                alert('ì´ë¯¸ ë“±ë¡ëœ ì‚¬ë²ˆì…ë‹ˆë‹¤.');
                return;
            }
            
            // í•™ìƒ ë°°ì—´ ì´ˆê¸°í™” (ì—†ëŠ” ê²½ìš°)
            if (!educationData.students[courseId]) {
                educationData.students[courseId] = [];
            }
            if (!educationData.attendance[courseId]) {
                educationData.attendance[courseId] = {};
            }
            
            // í•™ìƒ ì¶”ê°€
            const newStudent = {
                name: name,
                employeeId: employeeId
            };
            
            educationData.students[courseId].push(newStudent);
            educationData.attendance[courseId][employeeId] = {
                name: name,
                employeeId: employeeId,
                checkinTime: null,
                checkoutTime: null
            };
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('manual-name').value = '';
            document.getElementById('manual-employee-id').value = '';
            
            updateCourseList();
            updateAttendanceList();
            saveDataToBrowser(); // ë°ì´í„° ì €ì¥
            alert(`${name}(${employeeId}) êµìœ¡ìƒì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // Excel íŒŒì¼ ì—…ë¡œë“œ
        function uploadExcel() {
            const file = document.getElementById('excel-file').files[0];
            const courseId = document.getElementById('select-course').value;
            
            if (!courseId) {
                alert('ë¨¼ì € ê³¼ì •ì„ ì„ íƒí•˜ì„¸ìš”.');
                return;
            }
            
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                
                const studentList = [];
                const duplicates = [];
                
                jsonData.forEach(row => {
                    if (row['ì´ë¦„'] && row['ì‚¬ë²ˆ']) {
                        const employeeId = row['ì‚¬ë²ˆ'].toString();
                        const name = row['ì´ë¦„'].toString();
                        
                        // ì¤‘ë³µ í™•ì¸
                        if (educationData.attendance[courseId] && educationData.attendance[courseId][employeeId]) {
                            duplicates.push(`${name}(${employeeId})`);
                        } else {
                            studentList.push({
                                name: name,
                                employeeId: employeeId
                            });
                        }
                    }
                });
                
                // ê¸°ì¡´ í•™ìƒ ë°°ì—´ ìœ ì§€í•˜ê³  ìƒˆë¡œìš´ í•™ìƒ ì¶”ê°€
                if (!educationData.students[courseId]) {
                    educationData.students[courseId] = [];
                }
                if (!educationData.attendance[courseId]) {
                    educationData.attendance[courseId] = {};
                }
                
                // ìƒˆë¡œìš´ í•™ìƒë“¤ ì¶”ê°€
                studentList.forEach(student => {
                    educationData.students[courseId].push(student);
                    educationData.attendance[courseId][student.employeeId] = {
                        name: student.name,
                        employeeId: student.employeeId,
                        checkinTime: null,
                        checkoutTime: null
                    };
                });
                
                updateCourseList();
                updateAttendanceList();
                saveDataToBrowser(); // ë°ì´í„° ì €ì¥
                
                let message = `${studentList.length}ëª…ì˜ êµìœ¡ìƒì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`;
                if (duplicates.length > 0) {
                    message += `\n\nì¤‘ë³µìœ¼ë¡œ ì œì™¸ëœ êµìœ¡ìƒ (${duplicates.length}ëª…):\n${duplicates.join(', ')}`;
                }
                alert(message);
            };
            
            reader.readAsArrayBuffer(file);
        }

        // êµìœ¡ìƒ ì‚­ì œ
        function removeStudent(courseId, employeeId) {
            if (confirm('ì •ë§ë¡œ ì´ êµìœ¡ìƒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // students ë°°ì—´ì—ì„œ ì œê±°
                if (educationData.students[courseId]) {
                    educationData.students[courseId] = educationData.students[courseId].filter(
                        student => student.employeeId !== employeeId
                    );
                }
                
                // attendance ê°ì²´ì—ì„œ ì œê±°
                if (educationData.attendance[courseId]) {
                    delete educationData.attendance[courseId][employeeId];
                }
                
                updateCourseList();
                updateAttendanceList();
                saveDataToBrowser(); // ë°ì´í„° ì €ì¥
                alert('êµìœ¡ìƒì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì¶œì„ í˜„í™© ì—…ë°ì´íŠ¸ (ë¡œê¹… ê°•í™”, ìë™ ê°±ì‹  ì—†ìŒ)
        function updateAttendanceList() {
            const courseId = document.getElementById('select-course').value;
            const tbody = document.getElementById('attendance-list');
            if (!tbody) {
                console.log('âš ï¸ ì¶œì„ í…Œì´ë¸” ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                return;
            }
            
            tbody.innerHTML = '';
            
            if (!courseId || !educationData.attendance[courseId]) {
                console.log('âš ï¸ ì„ íƒëœ ê³¼ì •ì´ ì—†ê±°ë‚˜ ì¶œì„ ë°ì´í„°ê°€ ì—†ìŒ');
                return;
            }
            
            const students = Object.values(educationData.attendance[courseId]);
            console.log(`ğŸ“Š ì¶œì„ í˜„í™© ìˆ˜ë™ ì—…ë°ì´íŠ¸: ê³¼ì • ${courseId}, í•™ìƒ ${students.length}ëª…`);
            
            students.forEach(student => {
                const row = tbody.insertRow();
                const checkinTime = student.checkinTime ? new Date(student.checkinTime).toLocaleTimeString('ko-KR') : '-';
                const checkoutTime = student.checkoutTime ? new Date(student.checkoutTime).toLocaleTimeString('ko-KR') : '-';
                
                let status = 'ë¯¸ì¶œì„';
                let statusColor = '#6c757d';
                let statusIcon = 'â­•';
                
                if (student.checkinTime && student.checkoutTime) {
                    status = 'ì¶œì„ì™„ë£Œ';
                    statusColor = '#28a745';
                    statusIcon = 'âœ…';
                } else if (student.checkinTime) {
                    status = 'ì…ì‹¤ì™„ë£Œ';
                    statusColor = '#007bff';
                    statusIcon = 'ğŸ”µ';
                }
                
                row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.employeeId}</td>
                    <td style="font-weight: bold;">${checkinTime}</td>
                    <td style="font-weight: bold;">${checkoutTime}</td>
                    <td style="color: ${statusColor}; font-weight: bold; font-size: 1.1em;">${statusIcon} ${status}</td>
                    <td>
                        <button class="btn btn-danger" onclick="removeStudent('${courseId}', '${student.employeeId}')" style="font-size: 0.8rem; padding: 5px 10px;">ì‚­ì œ</button>
                    </td>
                `;
            });
            
            // ìˆ˜ë™ ì—…ë°ì´íŠ¸ ì™„ë£Œ ë¡œê·¸
            const updateTime = new Date().toLocaleTimeString('ko-KR');
            console.log(`âœ… ì¶œì„ í˜„í™© ìˆ˜ë™ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${updateTime}`);
        }

        // ì˜¤ëŠ˜ ì§„í–‰ë˜ëŠ” ê³¼ì • ì°¾ê¸°
        function findTodayCourse() {
            const today = new Date().toISOString().split('T')[0];
            const todayCourse = educationData.courses.find(course => course.date === today);
            
            const courseInfoSection = document.getElementById('course-info-section');
            
            if (todayCourse) {
                const studentCount = educationData.students[todayCourse.id] ? educationData.students[todayCourse.id].length : 0;
                courseInfoSection.innerHTML = `
                    <div class="course-info">
                        <h3>ğŸ“š ì˜¤ëŠ˜ì˜ êµìœ¡ê³¼ì •</h3>
                        <p><strong>${todayCourse.name}</strong></p>
                        <p>ğŸ“… ${todayCourse.date} | ğŸ‘¥ ë“±ë¡ì¸ì›: ${studentCount}ëª…</p>
                    </div>
                `;
            } else {
                courseInfoSection.innerHTML = `
                    <div class="course-info" style="background: #fff3cd; border-color: #ffeaa7;">
                        <h3 style="color: #856404;">ğŸ“… ì•ˆë‚´</h3>
                        <p style="color: #856404;">ì˜¤ëŠ˜ ì§„í–‰ë˜ëŠ” êµìœ¡ê³¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                        <p style="color: #856404; font-size: 0.9rem; margin-top: 5px;">ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.</p>
                    </div>
                `;
            }
        }

        // ê³¼ì • ì„ íƒ ë³€ê²½ ì‹œ ì¶œì„ í˜„í™© ì—…ë°ì´íŠ¸ (ê°•í™” ë²„ì „)
        document.addEventListener('change', function(e) {
            if (e.target && e.target.id === 'select-course') {
                console.log('=== ê³¼ì • ì„ íƒ ë³€ê²½ ===');
                
                // ê³¼ì • ì„ íƒ ì‹œ ë¬´ì¡°ê±´ ìµœì‹  ë°ì´í„° ê°•ì œ ë¡œë“œ
                loadDataFromBrowser();
                
                setTimeout(() => {
                    updateAttendanceList();
                    console.log('ê³¼ì • ì„ íƒ ë³€ê²½ - ì¶œì„ í˜„í™© ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                }, 200);
            }
        });

        // êµìœ¡ìƒ ì¶œì„ ì²˜ë¦¬ (ê°•ë ¥í•œ ë°ì´í„° ë™ê¸°í™”)
        function markAttendance() {
            const name = document.getElementById('student-name').value.trim();
            const employeeId = document.getElementById('student-id').value.trim();
            const type = document.getElementById('attendance-type').value;
            
            if (!name || !employeeId) {
                showAttendanceResult('ì´ë¦„ê³¼ ì‚¬ë²ˆì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.', 'error');
                return;
            }
            
            // ìµœì‹  ë°ì´í„° ê°•ì œ ë¡œë“œ
            loadDataFromBrowser();
            
            // ì˜¤ëŠ˜ ë‚ ì§œì™€ ì¼ì¹˜í•˜ëŠ” ê³¼ì • ì°¾ê¸°
            const today = new Date().toISOString().split('T')[0];
            const todayCourse = educationData.courses.find(course => course.date === today);
            
            if (!todayCourse) {
                showAttendanceResult('ì˜¤ëŠ˜ ì§„í–‰ë˜ëŠ” êµìœ¡ê³¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            // êµìœ¡ìƒ í™•ì¸
            if (!educationData.attendance[todayCourse.id] || !educationData.attendance[todayCourse.id][employeeId]) {
                showAttendanceResult('ë“±ë¡ë˜ì§€ ì•Šì€ êµìœ¡ìƒì…ë‹ˆë‹¤.', 'error');
                return;
            }
            
            const student = educationData.attendance[todayCourse.id][employeeId];
            
            // ì´ë¦„ í™•ì¸
            if (student.name !== name) {
                showAttendanceResult('ì´ë¦„ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            const now = new Date();
            
            if (type === 'checkin') {
                if (student.checkinTime) {
                    showAttendanceResult('ì´ë¯¸ ì…ì‹¤ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'error');
                    return;
                }
                student.checkinTime = now.toISOString();
                showAttendanceResult(`ì…ì‹¤ ì™„ë£Œ! (${now.toLocaleTimeString('ko-KR')})`, 'success');
                console.log(`[ì¶œì„] ${name}(${employeeId}) ì…ì‹¤ ì™„ë£Œ`);
            } else {
                if (!student.checkinTime) {
                    showAttendanceResult('ì…ì‹¤ ì²˜ë¦¬ê°€ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }
                if (student.checkoutTime) {
                    showAttendanceResult('ì´ë¯¸ í‡´ì‹¤ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'error');
                    return;
                }
                student.checkoutTime = now.toISOString();
                showAttendanceResult(`í‡´ì‹¤ ì™„ë£Œ! (${now.toLocaleTimeString('ko-KR')})`, 'success');
                console.log(`[ì¶œì„] ${name}(${employeeId}) í‡´ì‹¤ ì™„ë£Œ`);
            }
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('student-name').value = '';
            document.getElementById('student-id').value = '';
            
            console.log('=== ì¶œì„ ì²˜ë¦¬ í›„ ë°ì´í„° ì €ì¥ ===');
            console.log('ì €ì¥ ì „ ë°ì´í„°:', educationData.attendance[todayCourse.id][employeeId]);
            
            // ê°•ë ¥í•œ ë°ì´í„° ì €ì¥ ë° ë™ê¸°í™”
            saveDataToBrowser();
            
            // ì¶”ê°€ë¡œ ê°•ì œ ë™ê¸°í™”
            setTimeout(() => {
                forceSyncData();
                console.log('ì¶œì„ ì²˜ë¦¬ ì™„ë£Œ ë° ë°ì´í„° ë™ê¸°í™”');
            }, 100);
        }

        // ì¶œì„ ê²°ê³¼ í‘œì‹œ
        function showAttendanceResult(message, type) {
            const resultDiv = document.getElementById('attendance-result');
            if (!resultDiv) return;
            
            resultDiv.className = `attendance-status status-${type}`;
            resultDiv.textContent = message;
            
            // 3ì´ˆ í›„ ë©”ì‹œì§€ ì œê±°
            setTimeout(() => {
                resultDiv.textContent = '';
                resultDiv.className = '';
            }, 3000);
        }

        // ì´ˆê¸° ì„¤ì • ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (íƒ­ ê°„ ë™ê¸°í™” ì¶”ê°€)
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ === í˜ì´ì§€ ì´ˆê¸°í™” ì‹œì‘ ===');
            
            // 1ë‹¨ê³„: ì €ì¥ëœ ë°ì´í„° ë³µêµ¬
            const dataLoaded = loadDataFromBrowser();
            if (dataLoaded) {
                console.log('âœ… ì €ì¥ëœ ë°ì´í„° ë³µêµ¬ ì„±ê³µ');
            } else {
                console.log('âš ï¸ ì €ì¥ëœ ë°ì´í„° ì—†ìŒ - ìƒˆë¡œ ì‹œì‘');
            }
            
            // 2ë‹¨ê³„: íƒ­ ê°„ ë™ê¸°í™” ì„¤ì •
            setupCrossTabSync();
            
            // 3ë‹¨ê³„: ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            
            // ê¸€ë¡œë²Œ ë°ì´í„° ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            window.addEventListener('educationDataChanged', function(event) {
                console.log('ğŸ”„ ë°ì´í„° ë³€ê²½ ì´ë²¤íŠ¸ ìˆ˜ì‹ :', event.detail);
                // ìë™ UI ìƒˆë¡œê³ ì¹¨ ì œê±°
            });
            
            // 4ë‹¨ê³„: í•´ì‹œ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë° ì´ˆê¸° ë¼ìš°íŒ…
            window.addEventListener('hashchange', handleHashChange);
            
            // 5ë‹¨ê³„: ì´ˆê¸° í•´ì‹œ ì²˜ë¦¬ (ì§€ì—° ì‹¤í–‰ìœ¼ë¡œ DOM ì™„ì„± ëŒ€ê¸°)
            setTimeout(() => {
                console.log('ğŸ¯ ì´ˆê¸° ë¼ìš°íŒ… ì‹œì‘');
                handleHashChange();
                
                // ê¸°ë³¸ í˜ì´ì§€ ì„¤ì •
                if (!window.location.hash) {
                    showSystemSelector();
                }
                
            }, 300);
            
            // 6ë‹¨ê³„: ê¸°íƒ€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            
            // í˜ì´ì§€ ì¢…ë£Œ ì‹œ ì •ë¦¬
            window.addEventListener('beforeunload', function() {
                saveDataToBrowser();
                stopAdminAutoRefresh();
                
                // BroadcastChannel ì •ë¦¬
                if (window.educationBroadcast) {
                    window.educationBroadcast.close();
                }
            });
            
            // ì£¼ê¸°ì  ìë™ ì €ì¥ (30ì´ˆë§ˆë‹¤)
            setInterval(function() {
                saveDataToBrowser();
            }, 30000);
            
            // ì£¼ê¸°ì  íƒ­ ê°„ ë™ê¸°í™” í™•ì¸ (ì™„ì „ ë¹„í™œì„±í™”)
            // ëª¨ë“  ìë™ ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥ ë¹„í™œì„±í™”
            console.log('ğŸš« ëª¨ë“  ì£¼ê¸°ì  ìë™ ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥ ë¹„í™œì„±í™”');
            
            // ì—”í„° í‚¤ ì´ë²¤íŠ¸ (êµìœ¡ìƒ ì‹œìŠ¤í…œìš©)
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !document.getElementById('student-system').classList.contains('hidden')) {
                    const activeElement = document.activeElement;
                    if (activeElement.id === 'student-name') {
                        document.getElementById('student-id').focus();
                    } else if (activeElement.id === 'student-id') {
                        document.getElementById('attendance-type').focus();
                    } else if (activeElement.id === 'attendance-type') {
                        markAttendance();
                    }
                }
            });
            
            console.log('ğŸ‰ === í˜ì´ì§€ ì´ˆê¸°í™” ì™„ë£Œ ===');
        });
    </script>
</body>
</html>
